local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

-- Define the main frame and its properties
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SampleGui"
screenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false -- Disable ResetOnSpawn

local mainFrame = Instance.new("Frame")
mainFrame.BackgroundColor3 = Color3.fromRGB(128, 128, 128)
mainFrame.BackgroundTransparency = 0.5
mainFrame.Position = UDim2.new(0.5, -150, 0.5, -75)
mainFrame.Size = UDim2.new(0, 300, 0, 200)
mainFrame.Parent = screenGui

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 15)
uiCorner.Parent = mainFrame

local uiStroke = Instance.new("UIStroke")
uiStroke.Color = Color3.fromRGB(255, 255, 255)
uiStroke.Thickness = 2
uiStroke.Parent = mainFrame

-- Define tabs
local tabContainer = Instance.new("Frame")
tabContainer.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
tabContainer.BackgroundTransparency = 0.5
tabContainer.Size = UDim2.new(1, 0, 0, 40)
tabContainer.Position = UDim2.new(0, 0, 0, 0)
tabContainer.Parent = mainFrame

local tabCorner = Instance.new("UICorner")
tabCorner.CornerRadius = UDim.new(0, 15)
tabCorner.Parent = tabContainer

-- Define tab buttons
local function createTabButton(name, position)
    local button = Instance.new("TextButton")
    button.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    button.BackgroundTransparency = 1
    button.Position = position
    button.Size = UDim2.new(0, 100, 0, 40)
    button.Font = Enum.Font.SourceSans
    button.Text = name
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 18
    button.TextStrokeTransparency = 0
    button.Parent = tabContainer
    return button
end

local collectButton = createTabButton("Collect", UDim2.new(0, 0, 0, 0))
local blatantButton = createTabButton("Blatant", UDim2.new(0, 100, 0, 0))

-- Define frames
local collectFrame = Instance.new("Frame")
collectFrame.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
collectFrame.BackgroundTransparency = 0.5
collectFrame.Position = UDim2.new(0, 0, 0, 40)
collectFrame.Size = UDim2.new(1, 0, 1, -40)
collectFrame.Visible = false
collectFrame.Parent = mainFrame

local collectFrameCorner = Instance.new("UICorner")
collectFrameCorner.CornerRadius = UDim.new(0, 15)
collectFrameCorner.Parent = collectFrame

local blatantFrame = Instance.new("Frame")
blatantFrame.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
blatantFrame.BackgroundTransparency = 0.5
blatantFrame.Position = UDim2.new(0, 0, 0, 40)
blatantFrame.Size = UDim2.new(1, 0, 1, -40)
blatantFrame.Visible = false
blatantFrame.Parent = mainFrame

local blatantFrameCorner = Instance.new("UICorner")
blatantFrameCorner.CornerRadius = UDim.new(0, 15)
blatantFrameCorner.Parent = blatantFrame

-- Define the Collect buttons
local diamondButton = Instance.new("TextButton")
diamondButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
diamondButton.BackgroundTransparency = 1
diamondButton.Position = UDim2.new(0, 10, 0, 10)
diamondButton.Size = UDim2.new(0, 130, 0, 30)
diamondButton.Font = Enum.Font.SourceSans
diamondButton.Text = "Collect Diamonds"
diamondButton.TextColor3 = Color3.fromRGB(255, 255, 255)
diamondButton.TextSize = 18
diamondButton.TextStrokeTransparency = 0
diamondButton.Parent = collectFrame

local emeraldButton = Instance.new("TextButton")
emeraldButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
emeraldButton.BackgroundTransparency = 1
emeraldButton.Position = UDim2.new(0, 160, 0, 10)
emeraldButton.Size = UDim2.new(0, 130, 0, 30)
emeraldButton.Font = Enum.Font.SourceSans
emeraldButton.Text = "Collect Emeralds"
emeraldButton.TextColor3 = Color3.fromRGB(255, 255, 255)
emeraldButton.TextSize = 18
emeraldButton.TextStrokeTransparency = 0
emeraldButton.Parent = collectFrame

local collectAllDiamondsButton = Instance.new("TextButton")
collectAllDiamondsButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
collectAllDiamondsButton.BackgroundTransparency = 1
collectAllDiamondsButton.Position = UDim2.new(0, 10, 0, 50)
collectAllDiamondsButton.Size = UDim2.new(0, 130, 0, 30)
collectAllDiamondsButton.Font = Enum.Font.SourceSans
collectAllDiamondsButton.Text = "Collect All Diamonds"
collectAllDiamondsButton.TextColor3 = Color3.fromRGB(255, 255, 255)
collectAllDiamondsButton.TextSize = 18
collectAllDiamondsButton.TextStrokeTransparency = 0
collectAllDiamondsButton.Parent = collectFrame

local collectAllEmeraldsButton = Instance.new("TextButton")
collectAllEmeraldsButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
collectAllEmeraldsButton.BackgroundTransparency = 1
collectAllEmeraldsButton.Position = UDim2.new(0, 160, 0, 50)
collectAllEmeraldsButton.Size = UDim2.new(0, 130, 0, 30)
collectAllEmeraldsButton.Font = Enum.Font.SourceSans
collectAllEmeraldsButton.Text = "Collect All Emeralds"
collectAllEmeraldsButton.TextColor3 = Color3.fromRGB(255, 255, 255)
collectAllEmeraldsButton.TextSize = 18
collectAllEmeraldsButton.TextStrokeTransparency = 0
collectAllEmeraldsButton.Parent = collectFrame

-- Define the Kill Aura Button
local killAuraButton = Instance.new("TextButton")
killAuraButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
killAuraButton.BackgroundTransparency = 1
killAuraButton.Position = UDim2.new(0, 10, 0, 10)
killAuraButton.Size = UDim2.new(0, 130, 0, 30)
killAuraButton.Font = Enum.Font.SourceSans
killAuraButton.Text = "Kill Aura"
killAuraButton.TextColor3 = Color3.fromRGB(255, 255, 255)
killAuraButton.TextSize = 18
killAuraButton.TextStrokeTransparency = 0
killAuraButton.Parent = blatantFrame

-- Define the Fly Button
local flyButton = Instance.new("TextButton")
flyButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
flyButton.BackgroundTransparency = 1
flyButton.Position = UDim2.new(0, 10, 0, 50)
flyButton.Size = UDim2.new(0, 130, 0, 30)
flyButton.Font = Enum.Font.SourceSans
flyButton.Text = "Fly"
flyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
flyButton.TextSize = 18
flyButton.TextStrokeTransparency = 0
flyButton.Parent = blatantFrame

-- Define the Nuker Button
local nukerButton = Instance.new("TextButton")
nukerButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
nukerButton.BackgroundTransparency = 1
nukerButton.Position = UDim2.new(0, 10, 0, 90)
nukerButton.Size = UDim2.new(0, 130, 0, 30)
nukerButton.Font = Enum.Font.SourceSans
nukerButton.Text = "Nuker"
nukerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
nukerButton.TextSize = 18
nukerButton.TextStrokeTransparency = 0
nukerButton.Parent = blatantFrame

-- Define the X Button
local xButton = Instance.new("TextButton")
xButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
xButton.Position = UDim2.new(1, -30, 0, 0)
xButton.Size = UDim2.new(0, 30, 0, 30)
xButton.Font = Enum.Font.SourceSans
xButton.Text = "X"
xButton.TextColor3 = Color3.fromRGB(255, 255, 255)
xButton.TextSize = 20
xButton.TextStrokeTransparency = 0
xButton.Parent = screenGui

local xButtonCorner = Instance.new("UICorner")
xButtonCorner.CornerRadius = UDim.new(0, 15)
xButtonCorner.Parent = xButton

local toggleVisibilityButton = Instance.new("TextButton")
toggleVisibilityButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0) -- Green
toggleVisibilityButton.BackgroundTransparency = 0
toggleVisibilityButton.Position = UDim2.new(1, -30, 0, 0)
toggleVisibilityButton.Size = UDim2.new(0, 30, 0, 30)
toggleVisibilityButton.Font = Enum.Font.SourceSans
toggleVisibilityButton.Text = "+"
toggleVisibilityButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleVisibilityButton.TextSize = 20
toggleVisibilityButton.TextStrokeTransparency = 0
toggleVisibilityButton.Parent = screenGui

-- Toggle visibility functions
local function toggleFrameVisibility()
    mainFrame.Visible = not mainFrame.Visible
    toggleVisibilityButton.Text = mainFrame.Visible and "-" or "+"
end

toggleVisibilityButton.MouseButton1Click:Connect(toggleFrameVisibility)

xButton.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
    toggleVisibilityButton.Visible = true
end)

-- Set initial visibility
toggleVisibilityButton.Visible = false

-- Define tab functionality
local function showFrame(frameToShow)
    collectFrame.Visible = frameToShow == collectFrame
    blatantFrame.Visible = frameToShow == blatantFrame
end

collectButton.MouseButton1Click:Connect(function()
    showFrame(collectFrame)
end)

blatantButton.MouseButton1Click:Connect(function()
    showFrame(blatantFrame)
end)

-- Define functionality for buttons
local function getSwordName()
    local swords = {
        "Wooden Sword",
        "Stone Sword",
        "Diamond Sword",
        "Emerald Sword"
    }
    local player = Players.LocalPlayer
    local backpack = player.Backpack
    local swordName = "Wooden Sword"
    
    for _, sword in pairs(swords) do
        if backpack:FindFirstChild(sword) then
            swordName = sword
            break
        end
    end
    
    return swordName
end

local function findClosestBed()
    local closestBed = nil
    local shortestDistance = 15
    local playerPosition = Players.LocalPlayer.Character.HumanoidRootPart.Position
    
    for _, bed in pairs(Workspace.Map.Beds:GetChildren()) do
        local distance = (bed.Position - playerPosition).magnitude
        if distance < shortestDistance then
            shortestDistance = distance
            closestBed = bed
        end
    end
    
    return closestBed
end

local function onKillAuraToggle()
    local killAuraEnabled = false
    killAuraButton.BackgroundTransparency = 1
    
    local function updateKillAura()
        while killAuraEnabled do
            local closestPlayer = nil
            local shortestDistance = 18
            local playerPosition = Players.LocalPlayer.Character.HumanoidRootPart.Position
            
            for _, player in pairs(Players:GetPlayers()) do
                if player ~= Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                    local distance = (player.Character.HumanoidRootPart.Position - playerPosition).magnitude
                    if distance < shortestDistance and not player.Neutral and player.Team ~= Players.LocalPlayer.Team then
                        shortestDistance = distance
                        closestPlayer = player
                    end
                end
            end
            
            if closestPlayer then
                local args = {
                    [1] = closestPlayer.Character,
                    [2] = getSwordName()
                }
                ReplicatedStorage.Remotes.SwordAttack:FireServer(unpack(args))
            end
            
            wait(0.5)
        end
    end
    
    killAuraButton.MouseButton1Click:Connect(function()
        killAuraEnabled = not killAuraEnabled
        killAuraButton.BackgroundTransparency = killAuraEnabled and 0 or 1
        if killAuraEnabled then
            updateKillAura()
        end
    end)
end

local function onFlyToggle()
    local flying = false
    flyButton.BackgroundTransparency = 1
    
    flyButton.MouseButton1Click:Connect(function()
        flying = not flying
        flyButton.BackgroundTransparency = flying and 0 or 1
        if flying then
            game.Workspace.Gravity = 0
        else
            game.Workspace.Gravity = 196.2
        end
    end)
end

local function onNukerToggle()
    local nukerEnabled = false
    nukerButton.BackgroundTransparency = 1
    
    local function updateNuker()
        while nukerEnabled do
            local closestBed = findClosestBed()
            if closestBed then
                local args = {
                    [1] = closestBed,
                    [2] = getSwordName()
                }
                ReplicatedStorage.Remotes.DamageBlock:InvokeServer(unpack(args))
            end
            wait(1)
        end
    end
    
    nukerButton.MouseButton1Click:Connect(function()
        nukerEnabled = not nukerEnabled
        nukerButton.BackgroundTransparency = nukerEnabled and 0 or 1
        if nukerEnabled then
            updateNuker()
        end
    end)
end

-- Call the functions to initialize
onKillAuraToggle()
onFlyToggle()
onNukerToggle()

-- Cleanup
game.Players.LocalPlayer.Anticheat:Destroy()
game.StarterPlayer.StarterPlayerScripts.Anticheat:Destroy()
